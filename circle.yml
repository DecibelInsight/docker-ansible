machine:
  services:
    - docker

dependencies:
  override:
    - docker info
    - docker version

    - docker build  -t ansible_xenial           ubuntu16.04
    - docker build  -t ansible_trusty           ubuntu14.04

    - docker build  -t ansible_xenial_onbuild   ubuntu16.04-onbuild
    - docker build  -t ansible_trusty_onbuild   ubuntu14.04-onbuild

test:
  override:
    - docker run -i ansible_xenial           > result-ubuntu16.04
    - docker run -i ansible_trusty           > result-ubuntu14.04
    - docker run -i ansible_xenial_onbuild   > result-ubuntu16.04-onbuild
    - docker run -i ansible_trusty_onbuild   > result-ubuntu14.04-onbuild

    - echo "==> Validating the test results..."
    - sh -c "[ -s result-ubuntu16.04         ]"
    - sh -c "[ -s result-ubuntu14.04         ]"
    - sh -c "[ -s result-ubuntu16.04-onbuild ]"
    - sh -c "[ -s result-ubuntu14.04-onbuild ]"
